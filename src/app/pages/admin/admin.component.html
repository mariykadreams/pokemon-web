<main class="admin-box">
    <h1>Admin Panel</h1>
    
    <div *ngIf="!isAdmin" class="error-container">
        <p class="error-message">{{ errorMessage || 'Access denied. Admin privileges required.' }}</p>
        <a routerLink="/" class="btn">Go to Home</a>
    </div>

    <div *ngIf="isAdmin">
        <div class="admin-header">
            <div class="stats">
                <div class="stat-card">
                    <span class="stat-label">Total Users</span>
                    <span class="stat-value">{{ allUsers.length }}</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">Admins</span>
                    <span class="stat-value">{{ adminUsers.length }}</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">Regular Users</span>
                    <span class="stat-value">{{ normalUsers.length }}</span>
                </div>
            </div>
            <button class="btn refresh-btn" (click)="loadUsers()" [disabled]="isLoading">
                {{ isLoading ? 'Loading...' : 'Refresh' }}
            </button>
        </div>

        <div *ngIf="errorMessage" class="error-message">{{ errorMessage }}</div>

        <div *ngIf="isLoading" class="loading">Loading users...</div>

        <div *ngIf="!isLoading && allUsers.length === 0" class="no-users">
            <p>No users found.</p>
        </div>

        <!-- Admin Users Section -->
        <div *ngIf="!isLoading && adminUsers.length > 0" class="users-section">
            <h2>Administrators ({{ adminUsers.length }})</h2>
            <div class="users-table">
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Admin</th>
                            <th>Created</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let user of adminUsers" class="admin-row">
                            <td class="user-id">{{ user.id?.substring(0, 8) }}...</td>
                            <td>{{ user.name }}</td>
                            <td>{{ user.email }}</td>
                            <td>
                                <span class="badge admin-badge">Admin</span>
                            </td>
                            <td>{{ formatDate(user.whenCreated) }}</td>
                            <td>
                                <button 
                                    class="btn-toggle" 
                                    (click)="toggleAdminStatus(user)"
                                    title="Remove admin privileges">
                                    Remove Admin
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Normal Users Section -->
        <div *ngIf="!isLoading && normalUsers.length > 0" class="users-section">
            <h2>Regular Users ({{ normalUsers.length }})</h2>
            <div class="users-table">
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Admin</th>
                            <th>Created</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let user of normalUsers">
                            <td class="user-id">{{ user.id?.substring(0, 8) }}...</td>
                            <td>{{ user.name }}</td>
                            <td>{{ user.email }}</td>
                            <td>
                                <span class="badge user-badge">User</span>
                            </td>
                            <td>{{ formatDate(user.whenCreated) }}</td>
                            <td>
                                <button 
                                    class="btn-toggle" 
                                    (click)="toggleAdminStatus(user)"
                                    title="Grant admin privileges">
                                    Make Admin
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</main>

